<!--  Reference: https://malcoded.com/posts/angular-color-picker/ -->
<div class="color-panel">
    <div class="color-container">

        <button mat-fab
            [ngStyle]="{'background-color':colorService.mainColor.rgbValue,'opacity':colorService.mainColor.opacity}"
            (click)="selectColor(colorService.mainColor)" matTooltip="Couleur principale" matTooltipPosition="left"
            matTooltipShowDelay="1000"></button>

        <button mat-button (click)="switchColors()">
            <mat-icon>compare_arrows</mat-icon>
        </button>
        <button mat-mini-fab
            [ngStyle]="{'background-color':colorService.secondaryColor.rgbValue,'opacity':colorService.secondaryColor.opacity}"
            (click)="selectColor(colorService.secondaryColor)" matTooltip="Couleur secondaire"
            matTooltipPosition="right" matTooltipShowDelay="1000"></button>
    </div>
    <div *ngFor="let previousColor of previousColors; let index=index;" class="list-previous-color">
        <button mat-mini-fab class="previousColor" (click)="setPrimaryColor(index)"
            (contextmenu)="setSecondaryColor(index)"
            [ngStyle]="{'background-color':previousColor.rgbValue,'opacity':previousColor.opacity}"></button>
    </div>
    <div *ngIf="openColorPicker">
        <div class=color-wrapper>
            <app-color-palette [hue]="hue" (color)="color = $event"></app-color-palette>
            <app-color-slider (color)="hue=$event" style="margin-left:16px"></app-color-slider>
        </div>
        <div class="slider-container">
            <p class="opacity-title">Opacit√©</p>
            <mat-slider #slider class="opacity-slider" min="15" [value]="getOpacity()" (input)="updateOpacity($event)">
            </mat-slider>
            <p class="opacity-value">{{ opacity | number: '1.0-2' }}</p>
        </div>
        <div class="input-wrapper">
            <form class="rgb-form" *ngFor="let rgbInput of rgbInputs; let index=index">
                <mat-form-field>
                    <mat-label class="input" [ngStyle]="rgbInput.inputError && {'color':'red'}">{{rgbInput.color}}</mat-label>
                    <input  
                    type="text" 
                    class="input"
                    maxlength="3"
                    [value]="getRGB(index)"   
                    (input)="applyRGBInput($event.target.value,index)" [ngStyle]="rgbInput.inputError && {'color':'red'}" matInput>
                </mat-form-field>
                
            </form>

            <span class="preview-color" [ngStyle]="{'background-color':color,'opacity':opacity}"></span>

            <button mat-raised-button class="confirm-color-button" (click)="updateColor(selectedColor)">
                <fa-icon icon="check" class="check"></fa-icon>
            </button>

        </div>

    </div>
</div>